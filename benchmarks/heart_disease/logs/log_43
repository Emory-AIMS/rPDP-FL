../../fedrpdp/accountants/analysis/rdp.py:358: UserWarning: Optimal order is the smallest alpha. Please consider expanding the range of alphas to get a tighter privacy bound.
  f"Optimal order is the {extreme} alpha. Please consider expanding the range of alphas to get a tighter privacy bound."
noise_multiplier :  12.2509765625
Round=0, perf=[70, 57, 11, 28], mean perf=166/254 (0.6535%)
Round=1, perf=[73, 61, 11, 27], mean perf=172/254 (0.6772%)
Round=2, perf=[78, 62, 11, 28], mean perf=179/254 (0.7047%)
Round=3, perf=[79, 63, 11, 28], mean perf=181/254 (0.7126%)
Round=4, perf=[81, 64, 10, 29], mean perf=184/254 (0.7244%)
Round=5, perf=[80, 67, 10, 29], mean perf=186/254 (0.7323%)
Round=6, perf=[81, 68, 10, 30], mean perf=189/254 (0.7441%)
Round=7, perf=[82, 68, 10, 30], mean perf=190/254 (0.7480%)
Round=8, perf=[82, 68, 10, 30], mean perf=190/254 (0.7480%)
Round=9, perf=[82, 68, 10, 30], mean perf=190/254 (0.7480%)
Round=10, perf=[82, 68, 11, 29], mean perf=190/254 (0.7480%)
Round=11, perf=[82, 68, 11, 29], mean perf=190/254 (0.7480%)
Round=12, perf=[82, 68, 11, 30], mean perf=191/254 (0.7520%)
Round=13, perf=[82, 68, 11, 30], mean perf=191/254 (0.7520%)
Round=14, perf=[82, 69, 11, 30], mean perf=192/254 (0.7559%)
Mean performance without rPDP, Mean Perf=0.7533
r2 score of the curve fitting. 0.999881760403909
heart_disease_rpdp_fed.py:167: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  e = np.array([BoundedFunc(GENERATE_EPSILONS[name](len(train_dl.dataset), SETTINGS[name][int(p_id)])) for train_dl in training_dls])
sample_rate: 0.025357178940808994 / 0.025357178940808994, expected_batch_size: 5 / 199
Round=0, perf=[74, 53, 11, 30], mean perf=168/254 (0.6614%)
Round=1, perf=[75, 63, 11, 31], mean perf=180/254 (0.7087%)
Round=2, perf=[77, 59, 11, 32], mean perf=179/254 (0.7047%)
Round=3, perf=[79, 53, 13, 32], mean perf=177/254 (0.6969%)
Round=4, perf=[75, 62, 12, 30], mean perf=179/254 (0.7047%)
Round=5, perf=[78, 64, 11, 30], mean perf=183/254 (0.7205%)
Round=6, perf=[75, 65, 11, 30], mean perf=181/254 (0.7126%)
Round=7, perf=[79, 66, 12, 30], mean perf=187/254 (0.7362%)
Round=8, perf=[80, 66, 12, 30], mean perf=188/254 (0.7402%)
Round=9, perf=[79, 67, 12, 31], mean perf=189/254 (0.7441%)
Round=10, perf=[82, 67, 13, 30], mean perf=192/254 (0.7559%)
Round=11, perf=[80, 67, 12, 28], mean perf=187/254 (0.7362%)
Round=12, perf=[80, 69, 12, 28], mean perf=189/254 (0.7441%)
Round=13, perf=[80, 68, 12, 28], mean perf=188/254 (0.7402%)
Round=14, perf=[77, 66, 12, 28], mean perf=183/254 (0.7205%)
Mean performance of StrongForAll, eps=0.1, delta=0.001, Perf=0.7349
 We run FedAvg with rPDP (ThreeLevels-0) ...
sample_rate: 0.025357178940808994 / 0.5924704691170143, expected_batch_size: 21 / 199
Round=0, perf=[69, 54, 11, 29], mean perf=163/254 (0.6417%)
Round=1, perf=[72, 57, 11, 30], mean perf=170/254 (0.6693%)
Round=2, perf=[75, 61, 12, 30], mean perf=178/254 (0.7008%)
Round=3, perf=[73, 64, 12, 31], mean perf=180/254 (0.7087%)
Round=4, perf=[74, 63, 13, 31], mean perf=181/254 (0.7126%)
Round=5, perf=[78, 62, 13, 31], mean perf=184/254 (0.7244%)
Round=6, perf=[78, 65, 12, 31], mean perf=186/254 (0.7323%)
Round=7, perf=[78, 64, 12, 31], mean perf=185/254 (0.7283%)
Round=8, perf=[79, 62, 13, 31], mean perf=185/254 (0.7283%)
Round=9, perf=[79, 63, 12, 31], mean perf=185/254 (0.7283%)
Round=10, perf=[80, 63, 12, 31], mean perf=186/254 (0.7323%)
Round=11, perf=[79, 63, 12, 31], mean perf=185/254 (0.7283%)
Round=12, perf=[77, 64, 13, 31], mean perf=185/254 (0.7283%)
Round=13, perf=[79, 63, 12, 31], mean perf=185/254 (0.7283%)
Round=14, perf=[78, 61, 13, 32], mean perf=184/254 (0.7244%)
Mean performance of ThreeLevels, min_eps=0.1000, max_eps=5.0000, delta=0.001, Perf=0.7270, seed=43
 We run FedAvg with rPDP (Dropout) ...
sample_rate: 0.0 / 0.12011964891700398, expected_batch_size: 7 / 199
Round=0, perf=[67, 48, 12, 30], mean perf=157/254 (0.6181%)
Round=1, perf=[64, 54, 10, 29], mean perf=157/254 (0.6181%)
Round=2, perf=[72, 61, 10, 27], mean perf=170/254 (0.6693%)
Round=3, perf=[76, 65, 8, 24], mean perf=173/254 (0.6811%)
Round=4, perf=[71, 64, 7, 20], mean perf=162/254 (0.6378%)
Round=5, perf=[74, 69, 6, 21], mean perf=170/254 (0.6693%)
Round=6, perf=[75, 68, 9, 25], mean perf=177/254 (0.6969%)
Round=7, perf=[78, 68, 9, 27], mean perf=182/254 (0.7165%)
Round=8, perf=[80, 70, 8, 27], mean perf=185/254 (0.7283%)
Round=9, perf=[83, 71, 10, 28], mean perf=192/254 (0.7559%)
Round=10, perf=[81, 71, 12, 30], mean perf=194/254 (0.7638%)
Round=11, perf=[82, 71, 11, 27], mean perf=191/254 (0.7520%)
Round=12, perf=[78, 68, 10, 29], mean perf=185/254 (0.7283%)
Round=13, perf=[80, 68, 12, 29], mean perf=189/254 (0.7441%)
Round=14, perf=[81, 65, 11, 28], mean perf=185/254 (0.7283%)
Mean performance of Dropout, eps=0.7882471351284466, delta=0.001, Perf=0.7336
heart_disease_rpdp_fed.py:167: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  e = np.array([BoundedFunc(GENERATE_EPSILONS[name](len(train_dl.dataset), SETTINGS[name][int(p_id)])) for train_dl in training_dls])
sample_rate: 0.025415401211917193 / 0.025415401211917193, expected_batch_size: 5 / 199
Round=0, perf=[69, 54, 9, 24], mean perf=156/254 (0.6142%)
Round=1, perf=[70, 60, 10, 24], mean perf=164/254 (0.6457%)
Round=2, perf=[65, 57, 10, 25], mean perf=157/254 (0.6181%)
Round=3, perf=[65, 59, 11, 30], mean perf=165/254 (0.6496%)
Round=4, perf=[66, 52, 11, 29], mean perf=158/254 (0.6220%)
Round=5, perf=[71, 61, 10, 29], mean perf=171/254 (0.6732%)
Round=6, perf=[75, 64, 10, 27], mean perf=176/254 (0.6929%)
Round=7, perf=[76, 64, 11, 28], mean perf=179/254 (0.7047%)
Round=8, perf=[78, 68, 11, 28], mean perf=185/254 (0.7283%)
Round=9, perf=[78, 67, 10, 30], mean perf=185/254 (0.7283%)
Round=10, perf=[76, 68, 10, 28], mean perf=182/254 (0.7165%)
Round=11, perf=[77, 67, 11, 27], mean perf=182/254 (0.7165%)
Round=12, perf=[77, 65, 11, 28], mean perf=181/254 (0.7126%)
Round=13, perf=[79, 67, 12, 29], mean perf=187/254 (0.7362%)
Round=14, perf=[78, 66, 11, 27], mean perf=182/254 (0.7165%)
Mean performance of StrongForAll, eps=0.1004088482112361, delta=0.001, Perf=0.7218
 We run FedAvg with rPDP (BoundedPareto-0) ...
sample_rate: 0.025415401211917193 / 0.37675695244353896, expected_batch_size: 12 / 199
Round=0, perf=[70, 58, 11, 27], mean perf=166/254 (0.6535%)
Round=1, perf=[74, 59, 12, 30], mean perf=175/254 (0.6890%)
Round=2, perf=[75, 57, 12, 30], mean perf=174/254 (0.6850%)
Round=3, perf=[76, 60, 11, 30], mean perf=177/254 (0.6969%)
Round=4, perf=[80, 64, 11, 30], mean perf=185/254 (0.7283%)
Round=5, perf=[80, 67, 11, 28], mean perf=186/254 (0.7323%)
Round=6, perf=[79, 72, 10, 28], mean perf=189/254 (0.7441%)
Round=7, perf=[79, 73, 10, 27], mean perf=189/254 (0.7441%)
Round=8, perf=[77, 72, 10, 29], mean perf=188/254 (0.7402%)
Round=9, perf=[79, 71, 10, 29], mean perf=189/254 (0.7441%)
Round=10, perf=[75, 73, 10, 29], mean perf=187/254 (0.7362%)
Round=11, perf=[76, 73, 11, 30], mean perf=190/254 (0.7480%)
Round=12, perf=[76, 71, 11, 30], mean perf=188/254 (0.7402%)
Round=13, perf=[76, 74, 11, 30], mean perf=191/254 (0.7520%)
Round=14, perf=[78, 71, 11, 27], mean perf=187/254 (0.7362%)
Mean performance of BoundedPareto, min_eps=0.1004, max_eps=2.9015, delta=0.001, Perf=0.7428, seed=43
 We run FedAvg with rPDP (Dropout) ...
sample_rate: 0.0 / 0.06868225885594452, expected_batch_size: 4 / 199
Round=0, perf=[59, 49, 12, 27], mean perf=147/254 (0.5787%)
Round=1, perf=[66, 53, 9, 27], mean perf=155/254 (0.6102%)
Round=2, perf=[74, 55, 9, 27], mean perf=165/254 (0.6496%)
Round=3, perf=[72, 55, 5, 29], mean perf=161/254 (0.6339%)
Round=4, perf=[71, 56, 7, 27], mean perf=161/254 (0.6339%)
Round=5, perf=[65, 58, 6, 26], mean perf=155/254 (0.6102%)
Round=6, perf=[74, 58, 7, 30], mean perf=169/254 (0.6654%)
Round=7, perf=[71, 53, 4, 26], mean perf=154/254 (0.6063%)
Round=8, perf=[74, 60, 3, 25], mean perf=162/254 (0.6378%)
Round=9, perf=[74, 61, 5, 25], mean perf=165/254 (0.6496%)
Round=10, perf=[75, 60, 4, 28], mean perf=167/254 (0.6575%)
Round=11, perf=[71, 54, 5, 28], mean perf=158/254 (0.6220%)
Round=12, perf=[70, 56, 7, 26], mean perf=159/254 (0.6260%)
Round=13, perf=[70, 55, 8, 29], mean perf=162/254 (0.6378%)
Round=14, perf=[70, 52, 7, 30], mean perf=159/254 (0.6260%)
Mean performance of Dropout, eps=0.4089430180940846, delta=0.001, Perf=0.6299
heart_disease_rpdp_fed.py:167: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  e = np.array([BoundedFunc(GENERATE_EPSILONS[name](len(train_dl.dataset), SETTINGS[name][int(p_id)])) for train_dl in training_dls])
sample_rate: 0.025357178940808994 / 0.025357178940808994, expected_batch_size: 5 / 199
Round=0, perf=[67, 54, 6, 22], mean perf=149/254 (0.5866%)
Round=1, perf=[68, 59, 9, 20], mean perf=156/254 (0.6142%)
Round=2, perf=[77, 64, 9, 22], mean perf=172/254 (0.6772%)
Round=3, perf=[74, 65, 10, 25], mean perf=174/254 (0.6850%)
Round=4, perf=[76, 66, 11, 22], mean perf=175/254 (0.6890%)
Round=5, perf=[74, 62, 11, 26], mean perf=173/254 (0.6811%)
Round=6, perf=[77, 64, 11, 28], mean perf=180/254 (0.7087%)
Round=7, perf=[77, 66, 11, 28], mean perf=182/254 (0.7165%)
Round=8, perf=[81, 65, 11, 23], mean perf=180/254 (0.7087%)
Round=9, perf=[81, 64, 11, 27], mean perf=183/254 (0.7205%)
Round=10, perf=[81, 66, 10, 24], mean perf=181/254 (0.7126%)
Round=11, perf=[81, 68, 11, 27], mean perf=187/254 (0.7362%)
Round=12, perf=[82, 66, 11, 27], mean perf=186/254 (0.7323%)
Round=13, perf=[77, 65, 10, 25], mean perf=177/254 (0.6969%)
Round=14, perf=[74, 64, 10, 25], mean perf=173/254 (0.6811%)
Mean performance of StrongForAll, eps=0.1, delta=0.001, Perf=0.7034
 We run FedAvg with rPDP (BoundedMixGauss-0) ...
sample_rate: 0.025357178940808994 / 0.6850520226107414, expected_batch_size: 25 / 199
Round=0, perf=[66, 51, 9, 26], mean perf=152/254 (0.5984%)
Round=1, perf=[69, 57, 10, 27], mean perf=163/254 (0.6417%)
Round=2, perf=[72, 59, 9, 27], mean perf=167/254 (0.6575%)
Round=3, perf=[72, 61, 9, 31], mean perf=173/254 (0.6811%)
Round=4, perf=[76, 63, 8, 28], mean perf=175/254 (0.6890%)
Round=5, perf=[79, 63, 9, 28], mean perf=179/254 (0.7047%)
Round=6, perf=[79, 67, 9, 29], mean perf=184/254 (0.7244%)
Round=7, perf=[80, 69, 9, 29], mean perf=187/254 (0.7362%)
Round=8, perf=[78, 66, 9, 30], mean perf=183/254 (0.7205%)
Round=9, perf=[81, 68, 10, 29], mean perf=188/254 (0.7402%)
Round=10, perf=[80, 68, 10, 30], mean perf=188/254 (0.7402%)
Round=11, perf=[80, 69, 10, 30], mean perf=189/254 (0.7441%)
Round=12, perf=[80, 70, 10, 29], mean perf=189/254 (0.7441%)
Round=13, perf=[82, 70, 10, 31], mean perf=193/254 (0.7598%)
Round=14, perf=[80, 70, 10, 31], mean perf=191/254 (0.7520%)
Mean performance of BoundedMixGauss, min_eps=0.1000, max_eps=6.0037, delta=0.001, Perf=0.7520, seed=43
 We run FedAvg with rPDP (Dropout) ...
sample_rate: 0.0 / 0.10489998506826283, expected_batch_size: 6 / 199
Round=0, perf=[68, 57, 8, 26], mean perf=159/254 (0.6260%)
Round=1, perf=[66, 62, 7, 22], mean perf=157/254 (0.6181%)
Round=2, perf=[66, 59, 8, 25], mean perf=158/254 (0.6220%)
Round=3, perf=[73, 60, 6, 16], mean perf=155/254 (0.6102%)
Round=4, perf=[74, 63, 5, 18], mean perf=160/254 (0.6299%)
Round=5, perf=[77, 61, 6, 18], mean perf=162/254 (0.6378%)
Round=6, perf=[77, 64, 5, 18], mean perf=164/254 (0.6457%)
Round=7, perf=[75, 63, 5, 21], mean perf=164/254 (0.6457%)
Round=8, perf=[75, 63, 7, 23], mean perf=168/254 (0.6614%)
Round=9, perf=[80, 63, 7, 20], mean perf=170/254 (0.6693%)
Round=10, perf=[80, 62, 8, 20], mean perf=170/254 (0.6693%)
Round=11, perf=[81, 64, 9, 24], mean perf=178/254 (0.7008%)
Round=12, perf=[82, 66, 10, 23], mean perf=181/254 (0.7126%)
Round=13, perf=[84, 69, 10, 24], mean perf=187/254 (0.7362%)
Round=14, perf=[81, 67, 9, 26], mean perf=183/254 (0.7205%)
Mean performance of Dropout, eps=0.674574067945191, delta=0.001, Perf=0.7231
